<p style="color: green"><%= notice %></p>

<% content_for :title, "Products" %>

<h1>Products</h1>

<%= link_to "Add Product", new_product_path, class: "btn btn-primary mb-3" %>

<table class="table">
  <thead>
    <tr>
      <th>Name</th>
      <th>SKU</th>
      <th>Price</th>
      <th>Stock</th>
      <th>Threshold</th>
      <th colspan="3"></th>
    </tr>
  </thead>
  <tbody>
    <% @products.each do |product| %>
      <% row_class = product.stock_quantity < product.reorder_threshold ? "table-danger" : "" %>
      <tr class="<%= row_class %>">
        <td>
          <%= product.name %>
          <% if product.stock_quantity < product.reorder_threshold %>
            <span class="badge bg-warning text-dark">Low stock!</span>
          <% end %>
        </td>
        <td><%= product.sku %></td>
        <td><%= number_to_currency(product.price) %></td>
        <td><%= product.stock_quantity %></td>
        <td><%= product.reorder_threshold %></td>
        <td><%= link_to 'Show', product, class: "btn btn-sm btn-info" %></td>
        <td><%= link_to 'Edit', edit_product_path(product), class: "btn btn-sm btn-warning" %></td>
        <td>
          <%= link_to 'Destroy', product,
                      method: :delete,
                      data: { confirm: 'Are you sure?' },
                      class: "btn btn-sm btn-danger" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
